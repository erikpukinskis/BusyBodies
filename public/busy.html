<html> 
  <head> 
    <link type="text/css" rel="Stylesheet" media="screen" href="/screen.css" /> 
    <script type="text/javascript" src="/cake.js"></script>
    <script type="text/javascript" src="/mootools.js"></script>
   
    <script language="JavaScript" type="text/javascript"> 
      var canvas;
      
      window.onload = function() {
        
        canvas = new Canvas(document.body, 500, 500)
        drawFlower(canvas, 50, 185, 'blue');
        drawFlower(canvas, 400, 185, 'red');
        robot = drawRobot(canvas, 100, 100);
        
        robot.animateTo("x", 300, 500, 'sproing')
        
        group.when('focus', function(){
          // show bubble
        });
      }
      
      function drawRobot(node, x, y) {
        robot = new CanvasNode({x: x, y: y});
        bubble = new CanvasNode({x: 20, y: 0});
        body = new CanvasNode({x: 0, y: 50});
        
        drawRect(body, 10,10,50,30);     
        drawRect(body, 20,45,30,30);
        drawCircle(body, 20,25,4);
        drawCircle(body, 50,25,4);
        
        drawCircle(bubble, 35, 10, 30, 'white')
        drawCircle(bubble, 10, 15, 20, 'white')
        drawCircle(bubble, 60, 15, 20, 'white')
        drawCircle(bubble, 60, 15, 20, 'white')
        drawCircle(bubble, 55, 47, 7, 'white')
        drawCircle(bubble, 50, 59, 3, 'white')
        
        var shadow = new Ellipse  (15,2 , {
          x: 35,
          y: 135,
          fill: 'rgba(0,0,0,0.1)',
          endAngle: Math.PI*4
        });
        
        robot.append(shadow);
        

        robot.append(body);
        robot.append(bubble);
        node.append(robot);
        
        return robot;
      }
      
      function drawFlower(node, x, y, color) {
        flower = new CanvasNode({x: x, y: y});
        
        [[0,0],[10,-2],[2,10],[12,8]].each(function(array,i) {
          drawCircle(flower, array[0], array[1], 4, color);
        });

        var stem = new CatmullRomSpline( [[-20,-30], [6,5], [11, 40], [11,60]], { stroke: 'green' });
        
        flower.append(stem);
        node.append(flower);
        return flower;
      }
      
      function drawCircle(node, x, y, rad, color) {
        if (color == null) { color = 'black'}
        var circle = new Circle  (rad, {
          x: x,
          y: y,
          fill: color,
          endAngle: Math.PI*4
        })
        node.append(circle);
      }
      
      function drawRect(node,x,y,width,height, color) {
        if (color == null) { color = '#AAA'}
        var rect = new Rectangle(width, height, { 
          x: x,
          y: y,
          fill: color
        });
        node.append(rect);
      }

    </script> 
  </head> 
  <body> 
    <div style="display: none">
     <p>BusyBodies requires a web browser that supports the
     HTML5 "Canvas" feature, and your web browser does not. </p>
     
     <p>Install the lastest version of <a href="http://www.mozilla.com/en-US/">Firefox</a>, 
       <a href="http://www.google.com/chrome/">Google Chrome</a>, 
       <a href="http://www.apple.com/safari/">Safari</a>, 
       <a href="http://www.apple.com/safari/">Opera</a> and then try again with that browser.
       You can also try
       <a href="http://ie.microsoft.com/testdrive/">Internet Explorer 9</a>, but it's not
       a stable application yet, so install it at your own risk!</p>
   </div> 
 </body> 
</html>